webpackJsonp([0],{"/HIp":function(e,t){},"5bLQ":function(e,t){},"5dUc":function(e,t){e.exports={container:"_13MulXGcXOlUSTs5SsIb0F_0",buttons:"_2JnDezurcFveaoTgFqVJSm_0",button:"_1tAzopwXJNj7WfVPaYD7tZ_0"}},"82ZE":function(e,t){},HSZA:function(e,t){e.exports={wrapper:"_2NVDNRF3ZgVX9Hiw_AWRZw_0",phone:"_1icsiLMOwkovNsTgEmhAq1_0",name:"_2Vh8ZQ0M6yo-Reh0v9NbHa_0","column-first":"_1I0eONeCOL-s6oEcnWQUeX_0","column-second":"_1Pm2kvyyAws0vuysxf3Ivn_0",alert:"_1WhGIG1M0azsHiIRTzpY1l_0"}},IM1o:function(e,t){e.exports={table:"_263Zqr95GeTfNepMbHLa0u_0","column-title":"IV3OO8TcgS7yKlDvN0pWx_0"}},MVXd:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("7+uW"),r=s("mvHQ"),o=s.n(r),i={render:function(){var e=this.$createElement;return(this._self._c||e)("transition",{attrs:{appear:"",name:"zoom"}},[this._t("default")],2)},staticRenderFns:[]};var a={name:"ModalBase",components:{ZoomTransition:s("VU/8")({name:"ZoomTransition"},i,!1,function(e){s("MVXd")},null,null).exports},props:{isModalOpen:{type:Boolean,required:!0}},emits:["closeModal"],mounted:function(){document.addEventListener("keydown",this.handleKeydown)},beforeUnmount:function(){document.removeEventListener("keydown",this.handleKeydown)},methods:{handleKeydown:function(e){this.isModalOpen&&"Escape"===e.key&&this.close()},close:function(){this.$emit("closeModal")}}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("zoom-transition",[e.isModalOpen?s("div",{class:e.$style.mask,on:{click:e.close}},[s("div",{class:e.$style.wrapper},[s("div",{class:e.$style.container,attrs:{role:"dialog"},on:{click:function(e){e.stopPropagation()}}},[s("div",{class:e.$style.header},[e._t("header")],2),e._v(" "),s("div",{class:e.$style.body},[e._t("body")],2),e._v(" "),s("div",{class:e.$style.footer},[e._t("footer")],2),e._v(" "),s("button-base",{class:e.$style.close,attrs:{type:"button"},on:{click:e.close}},[e._v("x\n        ")])],1)])]):e._e()])},staticRenderFns:[]};var u=s("VU/8")(a,l,!1,function(e){this.$style=s("hruB")},null,null).exports,c={name:"InputBase",props:{value:{type:[String,Number],required:!0}},emits:["input"]},d={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("input",{domProps:{value:e.value},on:{input:function(t){return e.$emit("input",t.target.value)}}})},staticRenderFns:[]};var p=s("VU/8")(c,d,!1,function(e){this.$style=s("QWpJ")},null,null).exports,h={render:function(){var e=this.$createElement;return(this._self._c||e)("button",[this._t("default")],2)},staticRenderFns:[]},m=s("VU/8")({name:"ButtonBase"},h,!1,null,null,null).exports,f={name:"SelectBase",props:{options:{required:!0,type:Array,default:function(){return[]}},defaultValue:{required:!1,type:String},value:{type:String,required:!0}},emits:["input"]},_={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("select",{domProps:{value:e.value},on:{change:function(t){return e.$emit("input",t.target.value)}}},[s("option",{attrs:{disabled:"",value:""}},[e._v(e._s(e.defaultValue))]),e._v(" "),e._l(e.options,function(t){return s("option",{key:t.id,domProps:{value:t.id}},[e._v(e._s(t.name))])})],2)},staticRenderFns:[]};var v={name:"AddUserModal",data:function(){return{isFormValid:{phone:!1,name:!1},user:{name:"",phone:""},selectedOption:"",users:[]}},components:{SelectBase:s("VU/8")(f,_,!1,function(e){s("5bLQ")},"data-v-5bc883f3",null).exports,ModalBase:u,ButtonBase:m,InputBase:p},props:{isModalOpen:{type:Boolean,required:!0},usersStorage:{required:!1,type:Array}},emits:["closeModal","users"],computed:{isFormValidate:function(){return!this.isFormValid.name||!this.isFormValid.phone},isUsersStorageEmpty:function(){return this.usersStorage.length>0}},watch:{"user.name":function(){var e=this.user.name,t=e.length>0;this.isFormValid.name=t;var s=e.slice(0,1).toUpperCase()+e.slice(1);this.user.name=s},usersStorage:{handler:function(){var e=JSON.parse(o()(this.usersStorage)),t=[];this.flatUsers(e,t),this.users=t},immediate:!0}},methods:{close:function(){this.$emit("closeModal")},flatUsers:function(e,t){var s=this;e.forEach(function(e){e.hasOwnProperty("usersList")?(s.flatUsers(e.usersList,t),t.push(e)):t.push(e)})},addUser:function(){this.user.id=Math.random().toString(36).substring(2),this.user.phone=this.splitPhone(this.user.phone),this.$emit("users",{user:this.user,selectedOption:this.selectedOption}),this.clearForm(),this.close()},splitPhone:function(e){return[e.slice(0,2)," ",e.slice(2,5)," ",e.slice(5,8)," ",e.slice(8,10)," ",e.slice(10,12)].join("")},clearForm:function(){this.user={name:"",phone:""},this.isFormValid={name:!1,phone:!1},this.selectedOption=""},isPhoneValid:function(){this.isFormValid.phone=/^((\+7)+([0-9]){10})$/.test(this.user.phone)}}},y={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("modal-base",{attrs:{isModalOpen:e.isModalOpen},on:{closeModal:e.close},scopedSlots:e._u([{key:"header",fn:function(){return[s("span",{class:e.$style.title},[e._v("Добавление пользователя")])]},proxy:!0},{key:"body",fn:function(){var t,n;return[s("div",{class:e.$style.form},[s("label",{class:e.$style.label,attrs:{for:"name"}},[e._v("\n        Имя\n        "),s("input-base",{class:[[e.$style.input],(t={},t[e.$style.valid]=e.isFormValid.name,t)],attrs:{autofocus:"",type:"text",id:"name"},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1),e._v(" "),s("label",{class:e.$style.label,attrs:{for:"phone"}},[e._v("\n        Телефон\n        "),s("input-base",{class:[[e.$style.input],(n={},n[e.$style.valid]=e.isFormValid.phone,n)],attrs:{type:"text",id:"phone",maxlength:"12",minlength:"12",pattern:"[0-9]+"},on:{input:e.isPhoneValid},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1),e._v(" "),e.isUsersStorageEmpty?s("div",{class:e.$style["select-wrapper"]},[s("span",[e._v("\n          Начальник\n        ")]),e._v(" "),s("select-base",{class:e.$style.select,attrs:{"default-value":"Выберите начальника",id:"chief",options:e.users},model:{value:e.selectedOption,callback:function(t){e.selectedOption=t},expression:"selectedOption"}})],1):e._e()])]},proxy:!0},{key:"footer",fn:function(){var t;return[s("div",{class:e.$style.buttons},[s("button",{class:(t={},t[e.$style.button]=!e.isFormValidate,t),attrs:{disabled:e.isFormValidate,type:"button"},on:{click:e.addUser}},[e._v("\n        Сохранить\n      ")])])]},proxy:!0}])})},staticRenderFns:[]};var b=s("VU/8")(v,y,!1,function(e){this.$style=s("aMHQ")},null,null).exports,g=function(e){try{return JSON.parse(localStorage.getItem(e)||"[]")}catch(e){return console.log("Error getting data in LS"),null}},$=function(e,t){try{localStorage.setItem(e,o()(t))}catch(e){console.log("Error saving data in LS")}},M={render:function(){var e=this.$createElement;return(this._self._c||e)("transition-group",{attrs:{name:"user-list"}},[this._t("default")],2)},staticRenderFns:[]};var S=s("VU/8")({name:"ListTransition"},M,!1,function(e){s("/HIp")},null,null).exports,O={name:"UserTree",components:{ListTransition:S},props:{user:{type:Object,required:!0},spacing:{type:Number,default:0},margin:{type:Number,default:0},child:{type:Boolean}},computed:{userPadding:function(){return{"padding-left":this.spacing+"px"}},borderBottom:function(){return{"border-bottom":"0.05rem solid var(--grey)"}},hasChildren:function(){var e=this.user.usersList;return e&&e.length>0}}},U={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ul",{class:e.$style.body},[s("li",{class:e.$style.wrapper},[s("span",{class:e.$style.name,style:e.userPadding},[e.hasChildren?s("span",[e._v("+")]):e.child?s("span",[e._v("+")]):e._e(),e._v("\n      "+e._s(e.user.name))]),e._v(" "),s("span",{class:e.$style.phone},[e._v(e._s(e.user.phone))])]),e._v(" "),e.hasChildren?s("div",{class:e.$style["user-children"]},[s("list-transition",e._l(e.user.usersList,function(t){return s("user-tree",{key:t.id,attrs:{user:t,spacing:e.spacing+5,child:!0,margin:e.margin+5,"border-top":e.borderBottom}})}),1)],1):e._e()])},staticRenderFns:[]};var V={name:"UserList",components:{ListTransition:S,UserTree:s("VU/8")(O,U,!1,function(e){this.$style=s("HSZA")},null,null).exports},props:{users:{required:!1,type:Array}},emits:["sort"],methods:{sortList:function(){this.$emit("sort")}}},F={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:e.$style.table},[s("ul",{class:e.$style.title},[s("li",{class:[e.$style.column,e.$style["column-title"]]},[s("span",{style:{cursor:"pointer"},on:{click:e.sortList}},[e._v("Имя")]),e._v(" "),s("span",[e._v("Телефон")])])]),e._v(" "),s("list-transition",e._l(e.users,function(e){return s("user-tree",{key:e.id,attrs:{user:e}})}),1)],1)},staticRenderFns:[]};var x={name:"TableApp",components:{UserList:s("VU/8")(V,F,!1,function(e){this.$style=s("IM1o")},null,null).exports,AddUserModal:b},data:function(){return{isModalOpen:!1,toggleSort:!1,users:[],selectedOption:""}},created:function(){this.getUsers()},watch:{toggleSort:function(){this.toggleSort?this.sortByAsc(this.users):this.sortByDesc(this.users)},users:function(){$("users",this.users)}},methods:{openModal:function(){this.isModalOpen=!0},closeModal:function(){this.isModalOpen=!1},addUser:function(e){this.selectedOption=e.selectedOption;var t=this.addSubordinate(e);t?this.users=this.users.map(function(e){return e.id===t.id?t:e}):this.users.push(e.user)},addSubordinate:function(e){if(0!==e.selectedOption.length){var t=this.users.reduce(this.findById,null);return t.usersList||this.$set(t,"usersList",[]),t.usersList.push(e.user),t}},findById:function(e,t){return t.id===this.selectedOption?t:t.usersList?t.usersList.reduce(this.findById,e):e},getUsers:function(){var e=g("users");this.users=e},changeSort:function(){this.toggleSort=!this.toggleSort},sortByAsc:function(e){e.sort(this.compareName("name")),this.sortSubordinates(e,"asc")},sortByDesc:function(e){e.sort(this.compareName("name")).reverse(),this.sortSubordinates(e,"desc")},sortSubordinates:function(e,t){var s=this;e.forEach(function(e){if(e.hasOwnProperty("usersList")){var n=e.usersList;"desc"===t?s.sortByDesc(n):s.sortByAsc(n)}})},compareName:function(e){return function(t,s){return t[e]>s[e]?1:-1}}}},L={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:e.$style.container},[s("div",{class:e.$style.buttons},[s("button-base",{class:e.$style.button,attrs:{type:"button"},on:{click:e.openModal}},[e._v("Добавить")])],1),e._v(" "),s("user-list",{attrs:{users:e.users},on:{sort:e.changeSort}}),e._v(" "),s("add-user-modal",{attrs:{"users-storage":e.users,isModalOpen:e.isModalOpen},on:{users:e.addUser,closeModal:e.closeModal}})],1)},staticRenderFns:[]};var B=s("VU/8")(x,L,!1,function(e){this.$style=s("5dUc")},null,null).exports,k={name:"HomeView",components:{TableApp:B,UsersList:B}},E={render:function(){var e=this.$createElement;return(this._self._c||e)("table-app")},staticRenderFns:[]},w={components:{HomeView:s("VU/8")(k,E,!1,null,null,null).exports}},I={render:function(){var e=this.$createElement;return(this._self._c||e)("home-view")},staticRenderFns:[]};var N=s("VU/8")(w,I,!1,function(e){this.$style=s("82ZE")},null,null).exports;s("qJEI");n.a.config.productionTip=!1,new n.a({el:"#app",components:{App:N},template:"<App/>"})},QWpJ:function(e,t){},aMHQ:function(e,t){e.exports={title:"_1VFj27vzFeOjfupnWTIk9n_0",form:"_1Mm4FuTICkD_t8n9eqNAja_0",label:"_2k4Yl6SPEms21CndjXfNXC_0",buttons:"MR5AeVOmtSitxpjd8mI4t_0",button:"_3qTxJDYJW8LGiSCuzdgnk2_0",select:"_37BGYM_rGPX7yJS2iDIOIc_0","select-wrapper":"sG8_8EIMOtmUE5LYjhqIJ_0",valid:"_2HCDBuNpU2R8umsZbgtTFD_0"}},hruB:function(e,t){e.exports={mask:"_1uBwmGFJrDSam5Yx2D9ZI6_0",wrapper:"_1XOhYvYQpnPFWZObK7gXF1_0",container:"UZte6mk9uP_mRYFUPBC-T_0",header:"_84_L73YzBLlmlGq08_n2D_0",footer:"_2kWymjAPfwX72xwlv20XWD_0",body:"_34z_0oaXKwkQM30l5VBHk_0",button:"_7cDbe9TQpnr8L8HNxQbJK_0",close:"_1NL9ERxvpbtUvnh4HrQKsz_0"}},qJEI:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.8e663e4724b481b5f7e6.js.map